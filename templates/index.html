<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cronograma UTB</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- ========== LOGIN / REGISTRO ========== -->
<div id="loginScreen">
  <div class="auth-box">
    <div class="auth-logo">
      <span class="esc">ğŸ“</span>
      <h1>Universidad TecnolÃ³gica de BolÃ­var</h1>
      <p>Cronograma de Actividades</p>
    </div>

    <div class="auth-tabs">
      <button class="auth-tab active" onclick="switchTab('login')">Iniciar SesiÃ³n</button>
      <button class="auth-tab"        onclick="switchTab('reg')">Registrarse</button>
    </div>

    <!-- LOGIN -->
    <div id="tabLogin">
      <div class="fg">
        <label>ğŸ‘¤ Usuario</label>
        <input type="text" id="liUser" placeholder="Tu usuario"
               onkeydown="if(event.key==='Enter')login()">
      </div>
      <div class="fg">
        <label>ğŸ”’ ContraseÃ±a</label>
        <input type="password" id="liPass" placeholder="Tu contraseÃ±a"
               onkeydown="if(event.key==='Enter')login()">
      </div>
      <button class="btn-auth" onclick="login()">ğŸ” Ingresar</button>
      <div class="auth-msg" id="liMsg"></div>
    </div>

    <!-- REGISTRO -->
    <div id="tabReg" style="display:none">
      <div class="usuarios-info">
        MÃ¡ximo <strong>5 usuarios</strong> Â·
        Registrados: <strong id="cntUsers">0</strong> / 5
      </div>
      <div class="form-row">
        <div class="fg">
          <label>ğŸ‘¤ Nombre completo</label>
          <input type="text" id="rNombre" placeholder="Ej: Juan PÃ©rez">
        </div>
        <div class="fg">
          <label>ğŸ·ï¸ Usuario</label>
          <input type="text" id="rUser" placeholder="Sin espacios">
        </div>
      </div>
      <div class="fg">
        <label>ğŸ’¼ Cargo</label>
        <select id="rCargo">
          <option value="">-- Selecciona tu cargo --</option>
          <option>Director de proyecto</option>
          <option>Director de procesos Mecanicos</option>
          <option>Director de sitemas electronicos</option>
          <option>Desarrollador de sistema de control</option>
          <option>Director financiero</option>
        </select>
      </div>
      <div class="form-row">
        <div class="fg">
          <label>ğŸ”’ ContraseÃ±a</label>
          <input type="password" id="rPass" placeholder="MÃ­nimo 4 caracteres">
        </div>
        <div class="fg">
          <label>ğŸ”‘ Confirmar</label>
          <input type="password" id="rPass2" placeholder="Repite la contraseÃ±a">
        </div>
      </div>
      <button class="btn-auth verde" onclick="registrar()">âœ… Crear Cuenta</button>
      <div class="auth-msg" id="rMsg"></div>
    </div>
  </div>
</div>

<!-- ========== APP ========== -->
<div id="appScreen" style="display:none">

  <div class="app-header">
    <div class="h-left">
      <div class="h-logo">ğŸ“</div>
      <div class="h-title">
        <h1>Cronograma UTB</h1>
        <p>UNIVERSIDAD TECNOLÃ“GICA DE BOLÃVAR</p>
      </div>
    </div>
    <div class="h-right">
      <div class="u-chip">
        ğŸ‘¤ <span id="curUser">-</span> Â·
        <span id="curCargo"></span>
      </div>
      <button class="btn-out" onclick="logout()">Salir</button>
    </div>
  </div>

  <div class="accent-bar"></div>

  <!-- Leyenda de colores -->
  <div class="leyenda">
    <div class="li"><div class="ld am"></div>ğŸŸ¡ En ejecuciÃ³n (default)</div>
    <div class="li"><div class="ld az"></div>ğŸ”µ Completado prematuro (mÃ¡s de 7 dÃ­as antes)</div>
    <div class="li"><div class="ld vd"></div>ğŸŸ¢ Completado a tiempo (hasta 7 dÃ­as antes y el dÃ­a lÃ­mite)</div>
    <div class="li"><div class="ld na"></div>ğŸŸ  Retraso leve (hasta 7 dÃ­as despuÃ©s)</div>
    <div class="li"><div class="ld ro"></div>ğŸ”´ Retraso grave (mÃ¡s de 7 dÃ­as despuÃ©s)</div>
  </div>

  <div class="app-body">

    <!-- EstadÃ­sticas -->
    <div class="stats" id="statsGrid"></div>

    <!-- Barra de acciones -->
    <div class="act-bar">
      <h2>ğŸ“‹ Actividades del Proyecto</h2>
      <button class="btn-nueva" onclick="abrirModal()">ï¼‹ Nueva Actividad</button>
    </div>

    <!-- Filtros -->
    <div class="filtros">
      <button class="fb active" onclick="filtrar('todas',this)">Todas</button>
      <button class="fb" onclick="filtrar('default',this)">ğŸŸ¡ En ejecuciÃ³n</button>
      <button class="fb" onclick="filtrar('prematuro',this)">ğŸ”µ Prematuras</button>
      <button class="fb" onclick="filtrar('tiempo',this)">ğŸŸ¢ A tiempo</button>
      <button class="fb" onclick="filtrar('leve',this)">ğŸŸ  Retraso leve</button>
      <button class="fb" onclick="filtrar('tarde',this)">ğŸ”´ Retraso grave</button>
    </div>

    <!-- Tabla de actividades -->
    <div class="tabla-wrap">
      <div class="t-head">
        <span>Actividad</span>
        <span>Responsable</span>
        <span>Inicio</span>
        <span>Fecha lÃ­mite</span>
        <span>Estado</span>
        <span>Acciones</span>
      </div>
      <div id="actList"></div>
    </div>

  </div>
</div>

<!-- Modal Nueva / Editar Actividad -->
<div class="ov" id="modalAct">
  <div class="mbox">
    <button class="mcls" onclick="cerrarModal()">âœ•</button>
    <h3 id="mTitle">Nueva Actividad</h3>
    <div class="fg">
      <label>ğŸ“Œ Nombre *</label>
      <input type="text" id="aNom" placeholder="Nombre de la actividad">
    </div>
    <div class="fg">
      <label>ğŸ“ DescripciÃ³n</label>
      <textarea id="aDesc" rows="2" placeholder="DescripciÃ³n breve..."></textarea>
    </div>
    <div class="fg">
      <label>ğŸ‘¤ Responsable *</label>
      <input type="text" id="aResp" placeholder="Nombre del responsable">
    </div>
    <div class="form-row">
      <div class="fg">
        <label>ğŸ“… Fecha de Inicio *</label>
        <input type="date" id="aIni">
      </div>
      <div class="fg">
        <label>â° Fecha LÃ­mite *</label>
        <input type="date" id="aLim">
      </div>
    </div>
    <div class="fg">
      <label>ğŸ·ï¸ Prioridad</label>
      <select id="aPrio">
        <option value="alta">ğŸ”´ Alta</option>
        <option value="media" selected>ğŸŸ¡ Media</option>
        <option value="baja">ğŸŸ¢ Baja</option>
      </select>
    </div>
    <button class="btn-save" onclick="guardar()">ğŸ’¾ Guardar Actividad</button>
  </div>
</div>

<!-- Modal Confirmar Completar -->
<div class="cov" id="confirmOv">
  <div class="cbox">
    <div class="ci">âœ…</div>
    <h3>Â¿Marcar como completada?</h3>
    <p id="confirmTxt">Una vez confirmada no podrÃ¡ editarse.</p>

    <div class="fecha-comp-wrap">
      <label>ğŸ“… Fecha en que se completÃ³ *</label>
      <input type="date" id="fechaCompletado" readonly>
    </div>

    <div class="cbtns">
      <button class="btn-cy" onclick="confirmarCompletar()">SÃ­, confirmar</button>
      <button class="btn-cn" onclick="cerrarConfirm()">Cancelar</button>
    </div>
  </div>
</div>

<script>
function abrirConfirm() {
  const hoy = new Date().toISOString().split('T')[0];
  document.getElementById("fechaCompletado").value = hoy;
  document.getElementById("confirmOv").style.display = "flex";
}

function cerrarConfirm() {
  document.getElementById("confirmOv").style.display = "none";
}
</script>


<script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>